---
Source: .ruler/ruler/AGENTS.md
---
# AGENTS.md

# üìÇ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º **—á–∏—Å—Ç–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã** –∏ **Contract First**.  
–û—Å–Ω–æ–≤–Ω—ã–µ —Å–ª–æ–∏ –≤—ã–Ω–µ—Å–µ–Ω—ã –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞, –∞ `bot/` —Ö—Ä–∞–Ω–∏—Ç —Ç–æ–ª—å–∫–æ —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –¥–ª—è Telegram —ç–ª–µ–º–µ–Ω—Ç—ã.

---

## üìÇ –î–µ—Ä–µ–≤–æ –ø—Ä–æ–µ–∫—Ç–∞

```bash
src/
‚îú‚îÄ‚îÄ domain/                        # –ß–∏—Å—Ç–∞—è –ø—Ä–µ–¥–º–µ—Ç–Ω–∞—è –æ–±–ª–∞—Å—Ç—å
‚îÇ   ‚îú‚îÄ‚îÄ entities/                   # –°—É—â–Ω–æ—Å—Ç–∏ (User, Zodiac‚Ä¶)
‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ
‚îú‚îÄ‚îÄ data/                           # –î–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º
‚îÇ   ‚îú‚îÄ‚îÄ sources/                    # –ò—Å—Ç–æ—á–Ω–∏–∫–∏ (API, DB, fake)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user-network-source/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dto.ts              # –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã API
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ faker.ts            # –§–µ–π–∫–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user-network-source.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îú‚îÄ‚îÄ repositories/               # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (DTO ‚Üí Domain)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user.repository.ts
‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ
‚îú‚îÄ‚îÄ application/                    # Use-case —Å–ª–æ–π
‚îÇ   ‚îú‚îÄ‚îÄ services/                   # –°—Ü–µ–Ω–∞—Ä–∏–∏/–æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user.service.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ auth.service.ts
‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ
‚îú‚îÄ‚îÄ bot/                            # –í—Å—ë, —á—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å Telegram
‚îÇ   ‚îú‚îÄ‚îÄ features/                   # –§–∏—á–∏ (user stories)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ onboarding/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ handlers.ts         # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∞–ø–¥–µ–π—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ keyboards.ts        # –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã —Ñ–∏—á–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ middlewares.ts      # Middleware —É—Ä–æ–≤–Ω—è —Ñ–∏—á–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ helpers.ts
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ language/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ astrology/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ shared/                     # –û–±—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤–Ω—É—Ç—Ä–∏ –±–æ—Ç–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ keyboards/              # –û–±—â–∏–µ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ middlewares/            # –û–±—â–∏–µ middlewares
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ filters/                # –û–±—â–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ context.ts                  # DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä / BotContext
‚îÇ   ‚îú‚îÄ‚îÄ handlers/                   # –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ (error, commands)
‚îÇ   ‚îú‚îÄ‚îÄ i18n.ts                     # –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ index.ts                    # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –±–æ—Ç–∞
‚îÇ
‚îú‚îÄ‚îÄ shared/                         # –û–±—â–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≤—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ http/                       # HttpService, interceptors
‚îÇ   ‚îú‚îÄ‚îÄ cache/                      # CacheService (redis/in-memory)
‚îÇ   ‚îú‚îÄ‚îÄ logger.ts
‚îÇ   ‚îú‚îÄ‚îÄ config.ts
‚îÇ   ‚îî‚îÄ‚îÄ types/
‚îÇ
‚îú‚îÄ‚îÄ server/                         # Hono server (webhook)
‚îÇ   ‚îú‚îÄ‚îÄ index.ts
‚îÇ   ‚îú‚îÄ‚îÄ environment.ts
‚îÇ   ‚îî‚îÄ‚îÄ middlewares/
‚îÇ       ‚îú‚îÄ‚îÄ logger.ts
‚îÇ       ‚îú‚îÄ‚îÄ request-id.ts
‚îÇ       ‚îî‚îÄ‚îÄ request-logger.ts
‚îÇ
‚îî‚îÄ‚îÄ main.ts                         # Composition Root (—Å–±–æ—Ä–∫–∞ DI)
```

---

## üèóÔ∏è –î–æ–º–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏

### –ü—Ä–∏–Ω—Ü–∏–ø—ã —Å–æ–∑–¥–∞–Ω–∏—è Entity

–î–æ–º–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `src/domain/entities/` –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –±–∏–∑–Ω–µ—Å-–æ–±—ä–µ–∫—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –∏–∑ `class-transformer` –∏ `class-validator` –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö.

### –ü—Ä–∏–º–µ—Ä Entity - User

```ts
import { Expose, Transform, Type } from 'class-transformer'
import { IsOptional, IsInt, IsString, IsDate, IsBoolean, IsNumber } from 'class-validator'

export class User {
  @Expose()
  @IsOptional()
  @IsInt()
  id?: number

  @Expose()
  @Transform(({ value }) => value ?? undefined, { toClassOnly: true })
  @IsOptional()
  @IsString()
  email?: string

  @Expose()
  @Transform(({ value }) => value ?? undefined, { toClassOnly: true })
  @IsOptional()
  @IsString()
  provider?: string

  @Expose()
  @IsOptional()
  @IsString()
  socialId?: string

  @Expose()
  @IsOptional()
  @IsString()
  username?: string

  @Expose()
  @IsOptional()
  @IsString()
  firstName?: string

  @Expose()
  @IsOptional()
  @IsString()
  lastName?: string

  @Expose()
  @IsString()
  name!: string

  @Expose()
  @Type(() => Date)
  @IsOptional()
  @IsDate()
  birthDate?: Date

  @Expose()
  @IsOptional()
  @IsString()
  birthDateInput?: string

  @Expose()
  @IsOptional()
  @IsString()
  birthTime?: string

  @Expose()
  @IsOptional()
  @IsString()
  birthDateTime?: string

  @Expose()
  @IsOptional()
  @IsString()
  timezone?: string

  @Expose()
  @IsOptional()
  photo?: unknown

  @Expose()
  @IsOptional()
  @IsNumber({ allowNaN: false, allowInfinity: false })
  latitude?: number

  @Expose()
  @IsOptional()
  @IsNumber({ allowNaN: false, allowInfinity: false })
  longitude?: number

  @Expose()
  @IsOptional()
  @IsInt()
  zodiacId?: number

  @Expose()
  @IsOptional()
  @IsString()
  city?: string

  @Expose()
  @Type(() => Date)
  @IsOptional()
  @IsDate()
  createdAt?: Date

  @Expose()
  @Type(() => Date)
  @IsOptional()
  @IsDate()
  updatedAt?: Date

  @Expose()
  @IsBoolean()
  completedOnboarding!: boolean

  @Expose()
  @Type(() => Date)
  @IsDate()
  registrationDate!: Date

  static toDto(user: User) {
    return {
      id: user.id,
      name: user.name,
      email: user.email,
      completedOnboarding: user.completedOnboarding,
      // ... –¥—Ä—É–≥–∏–µ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è
    }
  }

  isOnboardingComplete(): boolean {
    return this.completedOnboarding
  }

  hasValidBirthData(): boolean {
    return !!(this.birthDate && this.birthTime && this.timezone)
  }
}
```

### –ü—Ä–∞–≤–∏–ª–∞ —Å–æ–∑–¥–∞–Ω–∏—è Entity

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏:**
   - `@Expose()` - –ø–æ–ª–µ –±—É–¥–µ—Ç —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–æ
   - `@IsOptional()` - –ø–æ–ª–µ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ
   - `@IsString()`, `@IsInt()`, `@IsBoolean()` - —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
   - `@Type(() => Date)` - —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –¥–∞—Ç

2. **Transform –¥–ª—è nullable –∑–Ω–∞—á–µ–Ω–∏–π:**

   ```ts
   @Transform(({ value }) => value ?? undefined, { toClassOnly: true })
   ```

3. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –ø–æ–º–µ—á–∞—é—Ç—Å—è `!`:**

   ```ts
   @IsString()
   name!: string
   ```

4. **–î–æ–±–∞–≤–ª—è–π—Ç–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É:**

   ```ts
   static toDto(entity: EntityClass) { /* ... */ }

   isCompleted(): boolean { /* ... */ }
   hasRequiredData(): boolean { /* ... */ }
   ```

5. **–í–∞–ª–∏–¥–∞—Ü–∏—è —á–∏—Å–µ–ª:**

   ```ts
   @IsNumber({ allowNaN: false, allowInfinity: false })
   ```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ domain

```bash
src/domain/
‚îú‚îÄ‚îÄ entities/
‚îÇ   ‚îú‚îÄ‚îÄ user.entity.ts
‚îÇ   ‚îú‚îÄ‚îÄ zodiac.entity.ts
‚îÇ   ‚îî‚îÄ‚îÄ index.ts
‚îî‚îÄ‚îÄ index.ts
```

### –≠–∫—Å–ø–æ—Ä—Ç entities

```ts
// src/domain/entities/index.ts
export { User } from './user.entity'
export { Zodiac } from './zodiac.entity'

// src/domain/index.ts
export * from './entities'
```

---

## üåê –ò–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è (i18n)

### –ü—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–±–æ—Ç—ã —Å i18n

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ª—é–±–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –±–æ—Ç–∞ **–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ**:

1. **–°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è** –Ω–∞ —Ä—É—Å—Å–∫–æ–º –∏ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–∞—Ö
2. **–¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ** –ø—Ä–∏–º–µ–Ω—è—Ç—å –∏—Ö –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö –±–æ—Ç–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏

```bash
locales/
‚îú‚îÄ‚îÄ ru.ftl                           # –†—É—Å—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã
‚îî‚îÄ‚îÄ en.ftl                           # –ê–Ω–≥–ª–∏–π—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã
```

### –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–æ–≤ `.ftl` (Fluent)

#### –ë–∞–∑–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

```ftl
# ru.ftl
welcome = –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –ö–∞–∫ –¥–µ–ª–∞?
help = –û—Ç–ø—Ä–∞–≤—å—Ç–µ –º–Ω–µ —Ç–µ–∫—Å—Ç, –∏ —è —Å–¥–µ–ª–∞—é –µ–≥–æ –∂–∏—Ä–Ω—ã–º.

# en.ftl
welcome = Welcome! How are you?
help = Send me some text and I'll make it bold.
```

#### –°–æ–æ–±—â–µ–Ω–∏—è —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

```ftl
# ru.ftl
cart-msg = –í –≤–∞—à–µ–π –∫–æ—Ä–∑–∏–Ω–µ { $items } { $items ->
    [one] —Ç–æ–≤–∞—Ä
    [few] —Ç–æ–≤–∞—Ä–∞
   *[other] —Ç–æ–≤–∞—Ä–æ–≤
}

# en.ftl
cart-msg = You have { $items } { $items ->
    [one] item
   *[other] items
} in your cart
```

#### –í–ª–æ–∂–µ–Ω–Ω—ã–µ –∫–ª—é—á–∏

```ftl
# ru.ftl
language.specify-a-locale = –£–∫–∞–∂–∏—Ç–µ –ª–æ–∫–∞–ª—å
language.invalid-locale = –ù–µ–≤–µ—Ä–Ω–∞—è –ª–æ–∫–∞–ª—å
language.already-set = –Ø–∑—ã–∫ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
language.language-set = –Ø–∑—ã–∫ –∏–∑–º–µ–Ω—ë–Ω

# en.ftl
language.specify-a-locale = Please specify a locale
language.invalid-locale = Invalid locale
language.already-set = Language already set
language.language-set = Language changed
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

#### –í –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö

```ts
bot.command("start", async (ctx) => {
  await ctx.reply(ctx.t("welcome"));
});

bot.command("help", async (ctx) => {
  await ctx.reply(ctx.t("help"));
});
```

#### –° –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

```ts
bot.command("cart", async (ctx) => {
  const itemCount = getUserCartCount(ctx.from.id);
  await ctx.reply(ctx.t("cart-msg", { items: itemCount }));
});
```

#### –í –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞—Ö

```ts
const keyboard = new InlineKeyboard()
  .text(ctx.t("button.confirm"), "confirm")
  .text(ctx.t("button.cancel"), "cancel");
```

### –ü—Ä–∞–≤–∏–ª–∞ –¥–ª—è LLM

1. **–í—Å–µ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞—Ç—å —Å —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤:**

   ```ftl
   # ru.ftl
   new-feature-msg = –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞!

   # en.ftl
   new-feature-msg = New feature available!
   ```

2. **–ó–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–æ–¥–µ:**

   ```ts
   await ctx.reply(ctx.t("new-feature-msg"));
   ```

3. **–î–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**

   ```ftl
   # ru.ftl
   user-profile = –ü—Ä–æ—Ñ–∏–ª—å { $name }, –≤–æ–∑—Ä–∞—Å—Ç: { $age }

   # en.ftl
   user-profile = Profile of { $name }, age: { $age }
   ```

4. **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:**

   ```ftl
   # ru.ftl
   errors.network = –û—à–∏–±–∫–∞ —Å–µ—Ç–∏
   errors.validation = –û—à–∏–±–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

   # en.ftl
   errors.network = Network error
   errors.validation = Validation error
   ```

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–Ω—è—Ç–Ω—ã–µ –∫–ª—é—á–∏: `welcome`, `help`, `user-profile`
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏: `errors.*`, `buttons.*`, `messages.*`
- –£—á–∏—Ç—ã–≤–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã –≤ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –æ–±–∞ —è–∑—ã–∫–∞ –ø–µ—Ä–µ–¥ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ–º

---

## üìù Code Style Guide (JS/TS)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

#### –ö–ª–∞—Å—Å—ã

- –ö–∞–∂–¥—ã–π –∫–ª–∞—Å—Å –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ kebab-case
- –ò–º—è —Ñ–∞–π–ª–∞ –∫–ª–∞—Å—Å–∞ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –∏–º–µ–Ω–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (constants.ts, enums.ts, utils/, *.test.ts) —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é—Ç—Å—è —Ä—è–¥–æ–º

‚úÖ **Valid:**

```
‚îú‚îÄ‚îÄ services/
|    ‚îú‚îÄ‚îÄ file-service/
|    |    ‚îú‚îÄ‚îÄ file-service.ts
|    |    ‚îú‚îÄ‚îÄ constants.ts
|    |    ‚îú‚îÄ‚îÄ enums.ts
|    |    ‚îú‚îÄ‚îÄ utils/
|    |    ‚îú‚îÄ‚îÄ file-service.test.ts
|    |    ‚îî‚îÄ‚îÄ index.ts
|    ‚îî‚îÄ‚îÄ index.ts
```

‚ùå **Invalid:**

```
‚îú‚îÄ‚îÄ services/
|    ‚îú‚îÄ‚îÄ file-service.ts
|    ‚îú‚îÄ‚îÄ error-service.ts
|    ‚îî‚îÄ‚îÄ index.ts
```

#### –í–ª–æ–∂–µ–Ω–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

- –í–ª–æ–∂–µ–Ω–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ –Ω–µ –¥–æ–ª–∂–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø—Ä–µ—Ñ–∏–∫—Å—ã —Ä–æ–¥–∏—Ç–µ–ª—è (user-card/header/header.ts ‚Üí Header, –∞ –Ω–µ UserCardHeader)
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∞, –Ω–æ –≥–ª—É–±–∏–Ω–∞ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–µ –±–æ–ª–µ–µ 4 —É—Ä–æ–≤–Ω–µ–π

### –ö–ª–∞—Å—Å—ã (JS/TS)

- –ü–æ–ª—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `private readonly`
- –ü—É–±–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏ —Å–≤–æ–π—Å—Ç–≤–∞ —è–≤–Ω–æ –ø–æ–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ `public`
- –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ –∏ —Å–≤–æ–π—Å—Ç–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∞–≤–∏–ª–∞–º –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

‚úÖ **Valid:**

```ts
class CartService {
  constructor(private readonly paymentService: PaymentService) {}

  public pay = () => {
    this.paymentService.pay()
  }
}
```

‚ùå **Invalid:**

```ts
class CartService {
  private readonly paymentService: PaymentService

  constructor(paymentService: PaymentService) {
    this.paymentService = paymentService
  }

  pay = () => {
    this.paymentService.pay()
  }
}
```

### –ü—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–æ–≤

#### Boolean

- –ò—Å–ø–æ–ª—å–∑—É–µ–º —è–≤–Ω–æ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ: `Boolean(value)`
- –ò—Å–∫–ª—é—á–µ–Ω–∏—è: —É—Å–ª–æ–≤–∏—è `if (value)` –∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä `!value`

#### Number

- –ò—Å–ø–æ–ª—å–∑—É–µ–º `Number()`, `Number.parseInt()`, `Number.parseFloat()`
- –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º `+value`, `1 * value`

#### String

- –ò—Å–ø–æ–ª—å–∑—É–µ–º `String(value)` –¥–ª—è –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è
- –î–ª—è –∫–æ–Ω–∫–∞—Ç–µ–Ω–∞—Ü–∏–∏ ‚Äî —à–∞–±–ª–æ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏

‚úÖ **Valid:**

```ts
const str = `${name} - ${count}`
```

‚ùå **Invalid:**

```ts
const str = name + ' - ' + count
```

### –£—Å–ª–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã

- –ó–∞–ø—Ä–µ—â–µ–Ω—ã –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Ç–µ—Ä–Ω–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã
- –î–æ–ø—É—Å—Ç–∏–º –æ–¥–∏–Ω —É—Ä–æ–≤–µ–Ω—å —Ç–µ—Ä–Ω–∞—Ä–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞

‚úÖ **Valid:**

```ts
const color = darkMode
  ? darkTheme.primary
  : lightTheme.primary
```

‚ùå **Invalid:**

```ts
const color = darkMode
  ? variant === 'primary'
    ? darkTheme.primary
    : darkTheme.secondary
  : ...
```

### –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ Enums

- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã ‚Äî –≤ UPPER_CASE
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã ‚Äî —Ç–æ–ª—å–∫–æ –∏–∑ —Ñ–∞–π–ª–∞ constants.ts
- Enums ‚Äî –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ enums.ts, –≤ PascalCase

‚úÖ **Valid:**

```ts
export enum UserType {
  NoAuth,
  Auth
}
```

‚ùå **Invalid:**

```ts
export enum userType {
  noAuth,
  auth
}
```

### TypeScript

- –ò—Å–ø–æ–ª—å–∑—É–µ–º `type`, –∞ –Ω–µ `interface` (–∫—Ä–æ–º–µ —Å–ª—É—á–∞–µ–≤ –∫–ª–∞—Å—Å–æ–≤, DTO –∏–ª–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –≤–Ω–µ—à–Ω–∏—Ö —Ç–∏–ø–æ–≤)
- Generics –Ω–∞–∑—ã–≤–∞–µ–º —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º T: `<TError, TResult>`
- –ò—Å–ø–æ–ª—å–∑—É–µ–º `Record` –≤–º–µ—Å—Ç–æ –æ–±—ä–µ–∫—Ç–Ω–æ–π –Ω–æ—Ç–∞—Ü–∏–∏
- `any` –∑–∞–ø—Ä–µ—â—ë–Ω, –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–º
- `@ts-ignore` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ–ª—å–∑—è (—Ç–æ–ª—å–∫–æ —Å –ø–æ—è—Å–Ω–µ–Ω–∏–µ–º –∏ –∫–∞–∫ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ)

### Utils

- –ö–∞–∂–¥–∞—è —É—Ç–∏–ª–∏—Ç–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å —Ä—è–¥–æ–º –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ

‚úÖ **Valid:**

```
‚îú‚îÄ‚îÄ utils/
|    ‚îú‚îÄ‚îÄ format-price/
|    |    ‚îú‚îÄ‚îÄ format-price.ts
|    |    ‚îú‚îÄ‚îÄ format-price.test.ts
|    |    ‚îî‚îÄ‚îÄ index.ts
|    ‚îî‚îÄ‚îÄ index.ts
```

‚ùå **Invalid:**

```
‚îú‚îÄ‚îÄ utils/
|    ‚îú‚îÄ‚îÄ format-price.ts
|    ‚îú‚îÄ‚îÄ format-date.ts
|    ‚îî‚îÄ‚îÄ index.ts
```

### –ì–ª–∞–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

1. **–Ø–≤–Ω–æ—Å—Ç—å** (`public`, `Boolean()`, `Number()`, `String()`)
2. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞** (–∫–∞–∂–¥–∞—è —Å—É—â–Ω–æ—Å—Ç—å ‚Äî –≤ —Å–≤–æ–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏, –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ enum –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö)
3. **–û–¥–Ω–æ—Ä–æ–¥–Ω–æ—Å—Ç—å** (kebab-case –¥–ª—è —Ñ–∞–π–ª–æ–≤, PascalCase –¥–ª—è enums, Record –≤–º–µ—Å—Ç–æ –æ–±—ä–µ–∫—Ç–æ–≤)
4. **–ü—Ä–æ—Å—Ç–æ—Ç–∞** (–Ω–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö —Ç–µ—Ä–Ω–∞—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤, –Ω–µ—Ç –≥–ª—É–±–æ–∫–æ–π –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π)

---

## ü§ñ Bot Development Guidelines

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ grammY Framework

–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ª—é–±—ã—Ö —Ñ–∏—á —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –±–æ—Ç–æ–º –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

- **grammY framework** –¥–ª—è –≤—Å–µ—Ö Telegram Bot API –æ–ø–µ—Ä–∞—Ü–∏–π
- **Context7 MCP** –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ `/grammyjs/website`
- **–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã** –∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ grammY

### –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∏—á –¥–ª—è –±–æ—Ç–∞

1. **–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Context7 MCP –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ grammY –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∏–º–µ—Ä—ã –≤ codebase
   - –°–ª–µ–¥–æ–≤–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –ø—Ä–æ–µ–∫—Ç–∞ (features, handlers, keyboards)

2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API:**
   - –í—Å–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ Telegram Bot API —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ grammY
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã grammY
   - –ü—Ä–∏–º–µ–Ω—è—Ç—å middleware –∏ plugins grammY –≥–¥–µ —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ

3. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∏—á:**

   ```
   src/bot/features/feature-name/
   ‚îú‚îÄ‚îÄ handlers.ts       # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π
   ‚îú‚îÄ‚îÄ keyboards.ts      # Inline –∏ Reply –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
   ‚îú‚îÄ‚îÄ middlewares.ts    # Middleware —É—Ä–æ–≤–Ω—è —Ñ–∏—á–∏
   ‚îú‚îÄ‚îÄ helpers.ts        # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
   ‚îî‚îÄ‚îÄ index.ts          # –≠–∫—Å–ø–æ—Ä—Ç —Ñ–∏—á–∏
   ```

4. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Context7 MCP —Å library `/grammyjs/website` –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è API
   - –°–ª–µ–¥–æ–≤–∞—Ç—å best practices –∏–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
   - –ü—Ä–∏–º–µ–Ω—è—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã grammY
